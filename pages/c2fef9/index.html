<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《Swift编程语言》- 表达式 | zhmbo</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/MouseClickEffect.js"></script>
    <script src="/js/FooterFish.js"></script>
    <meta name="description" content="zhmbo的技术博客,专注iOS技术分享,iOS,OC,Objective-C,Swift,SwiftUI,Apple,上架,Flutter,OpenGL,Xcode,Github,RxSwift,算法,架构,面试,zhmbo,zb,ZB,zhmbo,jumbo">
    <meta name="keywords" content="zhmbo,zhmbo,zhangbao,zhmbo的技术博客,个人博客,博客搭建,专注iOS技术分享,iOS,iOS进阶,iOS高级,OC,Objective-C,Swift,SwiftUI,Apple,上架,Flutter,OpenGL,Xcode,RxSwift,UIButton,UITableView,网络请求,Github,GithubActions,算法,架构,面试,zb,ZB,zhmbo,jumbo">
    <meta name="baidu-site-verification" content="code-l7ZsTFnxp5">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.8e525da2.css" as="style"><link rel="preload" href="/assets/js/app.f91ba302.js" as="script"><link rel="preload" href="/assets/js/2.dd713b59.js" as="script"><link rel="preload" href="/assets/js/3.069de0ac.js" as="script"><link rel="preload" href="/assets/js/43.fec22db6.js" as="script"><link rel="prefetch" href="/assets/js/10.eca7f202.js"><link rel="prefetch" href="/assets/js/100.884f2e2c.js"><link rel="prefetch" href="/assets/js/101.77e3c5d7.js"><link rel="prefetch" href="/assets/js/102.fbb46419.js"><link rel="prefetch" href="/assets/js/103.4285ab2f.js"><link rel="prefetch" href="/assets/js/104.b9d45e83.js"><link rel="prefetch" href="/assets/js/105.9af86ee7.js"><link rel="prefetch" href="/assets/js/106.f8baee69.js"><link rel="prefetch" href="/assets/js/107.fa4c186a.js"><link rel="prefetch" href="/assets/js/108.155cdba8.js"><link rel="prefetch" href="/assets/js/11.d5dc511b.js"><link rel="prefetch" href="/assets/js/12.126fd524.js"><link rel="prefetch" href="/assets/js/13.31add050.js"><link rel="prefetch" href="/assets/js/14.8f5927ce.js"><link rel="prefetch" href="/assets/js/15.5d73bb50.js"><link rel="prefetch" href="/assets/js/16.b7715387.js"><link rel="prefetch" href="/assets/js/17.b3336126.js"><link rel="prefetch" href="/assets/js/18.f0bd764d.js"><link rel="prefetch" href="/assets/js/19.7f321d7b.js"><link rel="prefetch" href="/assets/js/20.8a704687.js"><link rel="prefetch" href="/assets/js/21.6c9b4fd0.js"><link rel="prefetch" href="/assets/js/22.ce92c244.js"><link rel="prefetch" href="/assets/js/23.cbae088c.js"><link rel="prefetch" href="/assets/js/24.64936988.js"><link rel="prefetch" href="/assets/js/25.6ff36218.js"><link rel="prefetch" href="/assets/js/26.192e5aa3.js"><link rel="prefetch" href="/assets/js/27.5d49847d.js"><link rel="prefetch" href="/assets/js/28.865bfa0a.js"><link rel="prefetch" href="/assets/js/29.652b637f.js"><link rel="prefetch" href="/assets/js/30.2d2405ab.js"><link rel="prefetch" href="/assets/js/31.ff15975d.js"><link rel="prefetch" href="/assets/js/32.319807cb.js"><link rel="prefetch" href="/assets/js/33.b87269c8.js"><link rel="prefetch" href="/assets/js/34.2c88022c.js"><link rel="prefetch" href="/assets/js/35.090f353e.js"><link rel="prefetch" href="/assets/js/36.ef1f9b0b.js"><link rel="prefetch" href="/assets/js/37.ba5ce128.js"><link rel="prefetch" href="/assets/js/38.3c99d047.js"><link rel="prefetch" href="/assets/js/39.20a400e2.js"><link rel="prefetch" href="/assets/js/4.39a2702d.js"><link rel="prefetch" href="/assets/js/40.0f612174.js"><link rel="prefetch" href="/assets/js/41.c39b1818.js"><link rel="prefetch" href="/assets/js/42.73cd76fc.js"><link rel="prefetch" href="/assets/js/44.24cf9514.js"><link rel="prefetch" href="/assets/js/45.1a7bd4ad.js"><link rel="prefetch" href="/assets/js/46.2772e34b.js"><link rel="prefetch" href="/assets/js/47.b4eeef41.js"><link rel="prefetch" href="/assets/js/48.6e849ea1.js"><link rel="prefetch" href="/assets/js/49.e0c5a13d.js"><link rel="prefetch" href="/assets/js/5.5d94312a.js"><link rel="prefetch" href="/assets/js/50.773364d5.js"><link rel="prefetch" href="/assets/js/51.1db99b25.js"><link rel="prefetch" href="/assets/js/52.8c4dc63b.js"><link rel="prefetch" href="/assets/js/53.ebf1abab.js"><link rel="prefetch" href="/assets/js/54.016f21d7.js"><link rel="prefetch" href="/assets/js/55.73199a2d.js"><link rel="prefetch" href="/assets/js/56.3316e67d.js"><link rel="prefetch" href="/assets/js/57.57c6a9d7.js"><link rel="prefetch" href="/assets/js/58.65589959.js"><link rel="prefetch" href="/assets/js/59.abcabc64.js"><link rel="prefetch" href="/assets/js/6.8a416018.js"><link rel="prefetch" href="/assets/js/60.d382d1c3.js"><link rel="prefetch" href="/assets/js/61.c76620c7.js"><link rel="prefetch" href="/assets/js/62.44f03a5b.js"><link rel="prefetch" href="/assets/js/63.92fa470c.js"><link rel="prefetch" href="/assets/js/64.2475bc0a.js"><link rel="prefetch" href="/assets/js/65.e33c22e2.js"><link rel="prefetch" href="/assets/js/66.b213e189.js"><link rel="prefetch" href="/assets/js/67.54079f5f.js"><link rel="prefetch" href="/assets/js/68.9490fd8d.js"><link rel="prefetch" href="/assets/js/69.c9253eff.js"><link rel="prefetch" href="/assets/js/7.369ac24e.js"><link rel="prefetch" href="/assets/js/70.1c59f92a.js"><link rel="prefetch" href="/assets/js/71.3492471a.js"><link rel="prefetch" href="/assets/js/72.cec16c5f.js"><link rel="prefetch" href="/assets/js/73.50e8862b.js"><link rel="prefetch" href="/assets/js/74.086f16c5.js"><link rel="prefetch" href="/assets/js/75.5554210f.js"><link rel="prefetch" href="/assets/js/76.dfb35acc.js"><link rel="prefetch" href="/assets/js/77.440dde49.js"><link rel="prefetch" href="/assets/js/78.22d12fc4.js"><link rel="prefetch" href="/assets/js/79.7805a9b0.js"><link rel="prefetch" href="/assets/js/8.dd8ea451.js"><link rel="prefetch" href="/assets/js/80.0f6e99d9.js"><link rel="prefetch" href="/assets/js/81.775865b4.js"><link rel="prefetch" href="/assets/js/82.b0a6a6bc.js"><link rel="prefetch" href="/assets/js/83.b4431f89.js"><link rel="prefetch" href="/assets/js/84.9266dd31.js"><link rel="prefetch" href="/assets/js/85.6250c179.js"><link rel="prefetch" href="/assets/js/86.8def8d74.js"><link rel="prefetch" href="/assets/js/87.ae604169.js"><link rel="prefetch" href="/assets/js/88.ea0b4861.js"><link rel="prefetch" href="/assets/js/89.86dbd55a.js"><link rel="prefetch" href="/assets/js/9.d1ab447d.js"><link rel="prefetch" href="/assets/js/90.9225e7d0.js"><link rel="prefetch" href="/assets/js/91.f6bbf533.js"><link rel="prefetch" href="/assets/js/92.a7f31cba.js"><link rel="prefetch" href="/assets/js/93.540860df.js"><link rel="prefetch" href="/assets/js/94.2e3d73ab.js"><link rel="prefetch" href="/assets/js/95.e35292b9.js"><link rel="prefetch" href="/assets/js/96.c8174b05.js"><link rel="prefetch" href="/assets/js/97.f7b36c87.js"><link rel="prefetch" href="/assets/js/98.555706b2.js"><link rel="prefetch" href="/assets/js/99.70b5aa9a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8e525da2.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div class="width-limit"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link"><img src="https://cdn.jsdelivr.net/gh/zhmbo/static@master/img/202407311741918.png" alt="zhmbo" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont jumbo-nav-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="iOS" class="dropdown-title"><a href="/ios/" class="link-title"><i class="iconfont jumbo-apple"></i>
      iOS
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-apple"></i>
      iOS
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>iOS开发精髓</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/3f0170/" class="nav-link"><i class="iconfont undefined"></i>
  介绍
</a></li><li class="dropdown-subitem"><a href="/pages/7354af/" class="nav-link"><i class="iconfont undefined"></i>
  从入门
</a></li><li class="dropdown-subitem"><a href="/pages/1b29d1/" class="nav-link"><i class="iconfont undefined"></i>
  到放弃
</a></li></ul></li><li class="dropdown-item"><h4>iOS充电宝</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/5cb5f0/" class="nav-link"><i class="iconfont undefined"></i>
  SwiftUI
</a></li><li class="dropdown-subitem"><a href="/pages/9e761f/" class="nav-link"><i class="iconfont undefined"></i>
  iOS14
</a></li><li class="dropdown-subitem"><a href="/pages/5e2170/" class="nav-link"><i class="iconfont undefined"></i>
  Xcode12
</a></li><li class="dropdown-subitem"><a href="/pages/554b82/" class="nav-link"><i class="iconfont undefined"></i>
  iOS周边
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Swift" class="dropdown-title"><a href="/swift/" class="link-title"><i class="iconfont jumbo-swift"></i>
      Swift
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-swift"></i>
      Swift
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/04ed05/" class="nav-link"><i class="iconfont undefined"></i>
  概览
</a></li><li class="dropdown-item"><!----> <a href="/pages/cf2b9a/" class="nav-link"><i class="iconfont undefined"></i>
  欢迎来到Swift
</a></li><li class="dropdown-item"><!----> <a href="/pages/9e2f81/" class="nav-link"><i class="iconfont undefined"></i>
  Swift语法
</a></li><li class="dropdown-item"><!----> <a href="/pages/581348/" class="nav-link"><i class="iconfont undefined"></i>
  语言参考
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title"><i class="iconfont jumbo-jishu"></i>
      技术
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-jishu"></i>
      技术
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4f2c93/" class="nav-link"><i class="iconfont undefined"></i>
  博客
</a></li><li class="dropdown-item"><!----> <a href="/pages/6cbba7/" class="nav-link"><i class="iconfont undefined"></i>
  Github
</a></li><li class="dropdown-item"><!----> <a href="/pages/d9a627/" class="nav-link"><i class="iconfont undefined"></i>
  CocosCreator
</a></li><li class="dropdown-item"><!----> <a href="/pages/9af5e1/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/pages/46944a/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/pages/4b617e/" class="nav-link"><i class="iconfont undefined"></i>
  Android
</a></li><li class="dropdown-item"><!----> <a href="/pages/6ee1a4/" class="nav-link"><i class="iconfont undefined"></i>
  Git
</a></li></ul></div></div><div class="nav-item"><a href="/leaveword/" class="nav-link"><i class="iconfont jumbo-liuyan"></i>
  留言
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title"><i class="iconfont jumbo-suoyin"></i>
      索引
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-suoyin"></i>
      索引
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link"><i class="iconfont undefined"></i>
  分类
</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link"><i class="iconfont undefined"></i>
  标签
</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link"><i class="iconfont undefined"></i>
  归档
</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link"><i class="iconfont undefined"></i>
  友链
</a></li><li class="dropdown-item"><!----> <a href="/navigation/" class="nav-link"><i class="iconfont undefined"></i>
  导航
</a></li><li class="dropdown-item"><!----> <a href="/findme/" class="nav-link"><i class="iconfont undefined"></i>
  寻Me
</a></li></ul></div></div> <!----></nav></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/zhmbo/static@master/img/20200919111632.png"> <div class="blogger-info"><h3>@jumbo</h3> <span>an ios developer</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont jumbo-nav-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="iOS" class="dropdown-title"><a href="/ios/" class="link-title"><i class="iconfont jumbo-apple"></i>
      iOS
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-apple"></i>
      iOS
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>iOS开发精髓</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/3f0170/" class="nav-link"><i class="iconfont undefined"></i>
  介绍
</a></li><li class="dropdown-subitem"><a href="/pages/7354af/" class="nav-link"><i class="iconfont undefined"></i>
  从入门
</a></li><li class="dropdown-subitem"><a href="/pages/1b29d1/" class="nav-link"><i class="iconfont undefined"></i>
  到放弃
</a></li></ul></li><li class="dropdown-item"><h4>iOS充电宝</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/5cb5f0/" class="nav-link"><i class="iconfont undefined"></i>
  SwiftUI
</a></li><li class="dropdown-subitem"><a href="/pages/9e761f/" class="nav-link"><i class="iconfont undefined"></i>
  iOS14
</a></li><li class="dropdown-subitem"><a href="/pages/5e2170/" class="nav-link"><i class="iconfont undefined"></i>
  Xcode12
</a></li><li class="dropdown-subitem"><a href="/pages/554b82/" class="nav-link"><i class="iconfont undefined"></i>
  iOS周边
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Swift" class="dropdown-title"><a href="/swift/" class="link-title"><i class="iconfont jumbo-swift"></i>
      Swift
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-swift"></i>
      Swift
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/04ed05/" class="nav-link"><i class="iconfont undefined"></i>
  概览
</a></li><li class="dropdown-item"><!----> <a href="/pages/cf2b9a/" class="nav-link"><i class="iconfont undefined"></i>
  欢迎来到Swift
</a></li><li class="dropdown-item"><!----> <a href="/pages/9e2f81/" class="nav-link"><i class="iconfont undefined"></i>
  Swift语法
</a></li><li class="dropdown-item"><!----> <a href="/pages/581348/" class="nav-link"><i class="iconfont undefined"></i>
  语言参考
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title"><i class="iconfont jumbo-jishu"></i>
      技术
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-jishu"></i>
      技术
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4f2c93/" class="nav-link"><i class="iconfont undefined"></i>
  博客
</a></li><li class="dropdown-item"><!----> <a href="/pages/6cbba7/" class="nav-link"><i class="iconfont undefined"></i>
  Github
</a></li><li class="dropdown-item"><!----> <a href="/pages/d9a627/" class="nav-link"><i class="iconfont undefined"></i>
  CocosCreator
</a></li><li class="dropdown-item"><!----> <a href="/pages/9af5e1/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/pages/46944a/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/pages/4b617e/" class="nav-link"><i class="iconfont undefined"></i>
  Android
</a></li><li class="dropdown-item"><!----> <a href="/pages/6ee1a4/" class="nav-link"><i class="iconfont undefined"></i>
  Git
</a></li></ul></div></div><div class="nav-item"><a href="/leaveword/" class="nav-link"><i class="iconfont jumbo-liuyan"></i>
  留言
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title"><i class="iconfont jumbo-suoyin"></i>
      索引
    </a> <span class="title" style="display:none;"><i class="iconfont jumbo-suoyin"></i>
      索引
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link"><i class="iconfont undefined"></i>
  分类
</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link"><i class="iconfont undefined"></i>
  标签
</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link"><i class="iconfont undefined"></i>
  归档
</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link"><i class="iconfont undefined"></i>
  友链
</a></li><li class="dropdown-item"><!----> <a href="/navigation/" class="nav-link"><i class="iconfont undefined"></i>
  导航
</a></li><li class="dropdown-item"><!----> <a href="/findme/" class="nav-link"><i class="iconfont undefined"></i>
  寻Me
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/pages/04ed05/" class="sidebar-link">概览</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>欢迎来到Swift</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Swift语法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>语言参考</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/581348/" class="sidebar-link">关于语言参考</a></li><li><a href="/pages/4b779c/" class="sidebar-link">词法结构</a></li><li><a href="/pages/c85eb2/" class="sidebar-link">类型</a></li><li><a href="/pages/c2fef9/" aria-current="page" class="active sidebar-link">表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c2fef9/#前缀表达式" class="sidebar-link">前缀表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c2fef9/#try-运算符" class="sidebar-link">Try 运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#二元表达式" class="sidebar-link">二元表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c2fef9/#赋值表达式" class="sidebar-link">赋值表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#三元条件运算符" class="sidebar-link">三元条件运算符</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#类型转换运算符" class="sidebar-link">类型转换运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#基本表达式" class="sidebar-link">基本表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c2fef9/#字面量表达式" class="sidebar-link">字面量表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#self-表达式" class="sidebar-link">Self 表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#父类表达式" class="sidebar-link">父类表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#闭包表达式" class="sidebar-link">闭包表达式</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#捕获列表" class="sidebar-link">捕获列表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c2fef9/#隐式成员表达式" class="sidebar-link">隐式成员表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#圆括号表达式" class="sidebar-link">圆括号表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#元组表达式" class="sidebar-link">元组表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#通配符表达式" class="sidebar-link">通配符表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#key-path-表达式" class="sidebar-link">Key-path 表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#选择器表达式" class="sidebar-link">选择器表达式</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#key-path-字符串表达式" class="sidebar-link">Key-path 字符串表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#后缀表达式" class="sidebar-link">后缀表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/c2fef9/#函数调用表达式" class="sidebar-link">函数调用表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#构造器表达式" class="sidebar-link">构造器表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#显式成员表达式" class="sidebar-link">显式成员表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#后缀-self-表达式" class="sidebar-link">后缀 self 表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#下标表达式" class="sidebar-link">下标表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#强制取值表达式" class="sidebar-link">强制取值表达式</a></li><li class="sidebar-sub-header"><a href="/pages/c2fef9/#可选链表达式" class="sidebar-link">可选链表达式</a></li></ul></li></ul></li><li><a href="/pages/0c5243/" class="sidebar-link">语句</a></li><li><a href="/pages/756349/" class="sidebar-link">声明</a></li><li><a href="/pages/629202/" class="sidebar-link">特性</a></li><li><a href="/pages/55b4cd/" class="sidebar-link">模式</a></li><li><a href="/pages/a84bcd/" class="sidebar-link">泛型参数</a></li><li><a href="/pages/258164/" class="sidebar-link">语法总结</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-7e90c5a4><div class="articleInfo" data-v-7e90c5a4><ul class="breadcrumbs" data-v-7e90c5a4><li data-v-7e90c5a4><a href="/" title="首页" class="iconfont jumbo-home router-link-active" data-v-7e90c5a4></a></li> <li data-v-7e90c5a4><a href="/categories/?category=Swift%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80" title="分类" data-v-7e90c5a4>Swift编程语言</a></li> <li data-v-7e90c5a4><a href="/categories/?category=%E8%AF%AD%E8%A8%80%E5%8F%82%E8%80%83" title="分类" data-v-7e90c5a4>语言参考</a></li></ul> <div class="info" data-v-7e90c5a4><div title="作者" class="author iconfont jumbo-author" data-v-7e90c5a4><a href="https://github.com/zhmbo" target="_blank" title="作者" class="beLink" data-v-7e90c5a4>zhmbo</a></div> <div title="创建时间" class="date iconfont jumbo-time" data-v-7e90c5a4><a href="javascript:;" data-v-7e90c5a4>2020-11-11</a></div> <div title="统计" class="date iconfont jumbo-eye" data-v-7e90c5a4><span id="/pages/c2fef9/" data-flag-title="《Swift编程语言》- 表达式" class="leancloud-visitors" data-v-7e90c5a4><a class="leancloud-visitors-count" style="font-size:.7rem;font-weight:normal;color:#999;"></a></span></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          《Swift编程语言》- 表达式
        </h1> <div class="theme-vdoing-content content__default"><p>Swift 中存在四种表达式：前缀表达式，二元表达式，基本表达式和后缀表达式。表达式在返回一个值的同时还可以引发副作用。</p> <p>通过前缀表达式和二元表达式可以对简单表达式使用各种运算符。基本表达式从概念上讲是最简单的一种表达式，它是一种访问值的方式。后缀表达式则允许你建立复杂的表达式，例如函数调用和成员访问。每种表达式都在下面有详细论述。</p> <blockquote><p>表达式语法</p></blockquote> <h4 id="expression"><a href="#expression" class="header-anchor">#</a> expression</h4> <blockquote><p><em>表达式</em> → <a href="">try 运算符</a>可选 <a href="">前缀表达式</a> <a href="">二元表达式列表</a>可选</p></blockquote> <h4 id="expression-list"><a href="#expression-list" class="header-anchor">#</a> expression-list</h4> <blockquote><p><em>表达式列表</em> → <a href="">表达式</a> | <a href="">表达式</a> <strong>,</strong> <a href="">表达式列表</a></p></blockquote> <h2 id="前缀表达式"><a href="#前缀表达式" class="header-anchor">#</a> 前缀表达式</h2> <p>前缀表达式由可选的前缀运算符和表达式组成。前缀运算符只接收一个参数，表达式则紧随其后。</p> <p>关于这些运算符的更多信息，请参阅 <a href="">基本运算符</a> 和 <a href="">高级运算符</a>。</p> <p>关于 Swift 标准库提供的运算符的更多信息，请参阅 <a href="https://developer.apple.com/documentation/swift/operator_declarations" target="_blank" rel="noopener noreferrer"><em>Operators Declarations</em><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>除了标准库运算符，你也可以对某个变量使用 <code>&amp;</code> 运算符，从而将其传递给函数的输入输出参数。更多信息，请参阅 <a href="/pages/756349/#输入输出参数">输入输出参数</a>。</p> <blockquote><p>前缀表达式语法</p></blockquote> <h4 id="prefix-expression"><a href="#prefix-expression" class="header-anchor">#</a> prefix-expression</h4> <blockquote><p><em>前缀表达式</em> → <a href="">前缀运算符</a>可选 <a href="">后缀表达式</a></p> <p><em>前缀表达式</em> → <a href="">输入输出表达式</a></p></blockquote> <h4 id="in-out-expression"><a href="#in-out-expression" class="header-anchor">#</a> in-out-expression</h4> <blockquote><p><em>输入输出表达式</em> → <strong>&amp;</strong> <a href="">标识符</a></p></blockquote> <h3 id="try-运算符"><a href="#try-运算符" class="header-anchor">#</a> Try 运算符</h3> <p>try 表达式由 <code>try</code> 运算符加上紧随其后的可抛出错误的表达式组成，形式如下：</p> <blockquote><p>try <code>可抛出错误的表达式</code></p></blockquote> <p>可选的 try 表达式由 <code>try?</code> 运算符加上紧随其后的可抛出错误的表达式组成，形式如下：</p> <blockquote><p>try? <code>可抛出错误的表达式</code></p></blockquote> <p>如果可抛出错误的表达式没有抛出错误，整个表达式返回的可选值将包含可抛出错误的表达式的返回值，否则，该可选值为 <code>nil</code>。</p> <p>强制的 try 表达式由 <code>try!</code> 运算符加上紧随其后的可抛出错误的表达式组成，形式如下：</p> <blockquote><p>try! <code>可抛出错误的表达式</code></p></blockquote> <p>如果可抛出错误的表达式抛出了错误，将会引发运行时错误。</p> <p>在二元运算符左侧的表达式被标记上 <code>try</code>、<code>try?</code> 或者 <code>try!</code> 时，这个运算符对整个二元表达式都产生作用。也就是说，你可以使用括号来明确运算符的作用范围。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>sum <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token function">someThrowingFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">anotherThrowingFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// try 对两个函数调用都产生作用</span>
sum <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token function">someThrowingFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">anotherThrowingFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// try 对两个函数调用都产生作用</span>
sum <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">try</span> <span class="token function">someThrowingFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">anotherThrowingFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 错误：try 只对第一个函数调用产生作用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>try</code> 表达式不能出现在二元运算符的的右侧，除非二元运算符是赋值运算符或者 <code>try</code> 表达式是被圆括号括起来的。</p> <p>关于 <code>try</code>、<code>try?</code> 和 <code>try!</code> 的更多信息，以及该如何使用的例子，请参阅 <a href="/pages/cc5b2d/">错误处理</a>。</p> <blockquote><p>Try 表达式语法</p></blockquote> <h4 id="try-operator"><a href="#try-operator" class="header-anchor">#</a> try-operator</h4> <blockquote><p><em>try 运算符</em> → <strong>try</strong> | <strong>try?</strong> | <strong>try!</strong></p></blockquote> <h2 id="二元表达式"><a href="#二元表达式" class="header-anchor">#</a> 二元表达式</h2> <p><em>二元表达式</em>由中缀运算符和左右参数表达式组成。形式如下：</p> <blockquote><div class="language-swift line-numbers-mode"><pre class="language-swift"><code>左侧参数` `二元运算符` `右侧参数
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>关于这些运算符的更多信息，请参阅 <a href="">基本运算符</a> 和 <a href="">高级运算符</a>。</p> <p>关于 Swift 标准库提供的运算符的更多信息，请参阅 <a href="https://developer.apple.com/documentation/swift/operator_declarations" target="_blank" rel="noopener noreferrer"><em>Swift Standard Library Operators Reference</em><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>注意</p> <p>在解析时，一个二元表达式将作为一个扁平列表表示，然后根据运算符的优先级，再进一步进行组合。例如，<code>2 + 3 * 5</code> 首先被看作具有五个元素的列表，即 <code>2</code>、<code>+</code>、<code>3</code>、<code>*</code>、<code>5</code>，随后根据运算符优先级组合为 <code>(2 + (3 * 5))</code>。</p></blockquote> <h4 id="binary-expression"><a href="#binary-expression" class="header-anchor">#</a> binary-expression</h4> <blockquote><p>二元表达式语法</p> <p><em>二元表达式</em> → <a href="">二元运算符</a> <a href="">前缀表达式</a></p> <p><em>二元表达式</em> → <a href="">赋值运算符</a> <a href="">try 运算符</a>可选 <a href="">前缀表达式</a></p> <p><em>二元表达式</em> → <a href="">条件运算符</a> <a href="">try 运算符</a>可选 <a href="">前缀表达式</a></p> <p><em>二元表达式</em> → <a href="">类型转换运算符</a></p></blockquote> <h4 id="binary-expressions"><a href="#binary-expressions" class="header-anchor">#</a> binary-expressions</h4> <blockquote><p><em>二元表达式列表</em> → <a href="">二元表达式</a> <a href="">二元表达式列表</a>可选</p></blockquote> <h3 id="赋值表达式"><a href="#赋值表达式" class="header-anchor">#</a> 赋值表达式</h3> <p>赋值表达式会为某个给定的表达式赋值，形式如下；</p> <blockquote><div class="language-swift line-numbers-mode"><pre class="language-swift"><code>表达式` <span class="token operator">=</span> `值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>右边的值会被赋值给左边的表达式。如果左边表达式是一个元组，那么右边必须是一个具有同样元素个数的元组。（嵌套元组也是允许的。）右边的值中的每一部分都会被赋值给左边的表达式中的相应部分。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token omit keyword">_</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;test&quot;</span></span><span class="token punctuation">,</span> <span class="token number">9.45</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// a 为 &quot;test&quot;，b 为 12，c 为 3，9.45 会被忽略</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>赋值运算符不返回任何值。</p> <blockquote><p>赋值运算符语法</p></blockquote> <h4 id="assignment-operator"><a href="#assignment-operator" class="header-anchor">#</a> assignment-operator</h4> <blockquote><p><em>赋值运算符</em> → <strong>=</strong></p></blockquote> <h3 id="三元条件运算符"><a href="#三元条件运算符" class="header-anchor">#</a> 三元条件运算符</h3> <p><em>三元条件运算符</em>会根据条件来对两个给定表达式中的一个进行求值，形式如下：</p> <blockquote><div class="language-swift line-numbers-mode"><pre class="language-swift"><code>条件` <span class="token operator">?</span> `表达式（条件为真则使用）` <span class="token punctuation">:</span> `表达式（条件为假则使用）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>如果条件为真，那么对第一个表达式进行求值并返回结果。否则，对第二个表达式进行求值并返回结果。未使用的表达式不会进行求值。</p> <p>关于使用三元条件运算符的例子，请参阅 <a href="">三元条件运算符</a>。</p> <blockquote><p>三元条件运算符语法</p></blockquote> <h4 id="conditional-operator"><a href="#conditional-operator" class="header-anchor">#</a> conditional-operator</h4> <blockquote><p><em>三元条件运算符</em> → <strong>?</strong> <a href="">表达式</a> <strong>:</strong></p></blockquote> <h3 id="类型转换运算符"><a href="#类型转换运算符" class="header-anchor">#</a> 类型转换运算符</h3> <p>有 4 种类型转换运算符：<code>is</code>、<code>as</code>、<code>as?</code> 和 <code>as!</code>。它们有如下的形式：</p> <blockquote><div class="language-swift line-numbers-mode"><pre class="language-swift"><code>表达式` <span class="token keyword">is</span> `类型
表达式` <span class="token keyword">as</span> `类型
表达式` <span class="token keyword">as</span><span class="token operator">?</span> `类型
表达式` <span class="token keyword">as</span><span class="token operator">!</span> `类型
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></blockquote> <p><code>is</code> 运算符在运行时检查表达式能否向下转化为指定的类型，如果可以则返回 <code>ture</code>，否则返回 <code>false</code>。</p> <p><code>as</code> 运算符在编译时执行向上转换和桥接。向上转换可将表达式转换成父类的实例而无需使用任何中间变量。以下表达式是等价的：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">f</span><span class="token punctuation">(</span>any<span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Function for Any&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function-definition function">f</span><span class="token punctuation">(</span>int<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Function for Int&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">10</span>
<span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment">// 打印“Function for Int”</span>


<span class="token keyword">let</span> y<span class="token punctuation">:</span> <span class="token keyword">Any</span> <span class="token operator">=</span> x
<span class="token function">f</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token comment">// 打印“Function for Any”</span>


<span class="token function">f</span><span class="token punctuation">(</span>x <span class="token keyword">as</span> <span class="token keyword">Any</span><span class="token punctuation">)</span>
<span class="token comment">// 打印“Function for Any”</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>桥接可将 Swift 标准库中的类型（例如 <code>String</code>）作为一个与之相关的 Foundation 类型（例如 <code>NSString</code>）来使用，而不需要新建一个实例。关于桥接的更多信息，请参阅 <a href="https://developer.apple.com/documentation/swift/imported_c_and_objective_c_apis/working_with_foundation_types" target="_blank" rel="noopener noreferrer"><em>Working with Foundation Types</em><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p><code>as?</code> 运算符有条件地执行类型转换，返回目标类型的可选值。在运行时，如果转换成功，返回的可选值将包含转换后的值，否则返回 <code>nil</code>。如果在编译时就能确定转换一定会成功或是失败，则会导致编译报错。</p> <p><code>as!</code> 运算符执行强制类型转换，返回目标类型的非可选值。如果转换失败，则会导致运行时错误。表达式 <code>x as! T</code> 效果等同于 <code>(x as? T)!</code>。</p> <p>关于类型转换的更多内容和例子，请参阅 <a href="/pages/757c02/">类型转换</a>。</p> <h4 id="type-casting-operator"><a href="#type-casting-operator" class="header-anchor">#</a> type-casting-operator</h4> <blockquote><p>类型转换运算符语法</p> <p><em>类型转换运算符</em> → <strong>is</strong> <a href="">类型</a></p> <p><em>类型转换运算符</em> → <strong>as</strong> <a href="">类型</a></p> <p><em>类型转换运算符</em> → <strong>as</strong> <strong>?</strong> <a href="">类型</a></p> <p><em>类型转换运算符</em> → <strong>as</strong> <strong>!</strong> <a href="">类型</a></p></blockquote> <h2 id="基本表达式"><a href="#基本表达式" class="header-anchor">#</a> 基本表达式</h2> <p><em>基本表达式</em>是最基本的表达式。它们可以单独使用，也可以跟前缀表达式、二元表达式、后缀表达式组合使用。</p> <blockquote><p>基本表达式语法</p></blockquote> <h4 id="primary-expression"><a href="#primary-expression" class="header-anchor">#</a> primary-expression</h4> <blockquote><p><em>基本表达式</em> → <a href="">标识符</a> <a href="">泛型实参子句</a>可选</p> <p><em>基本表达式</em> → <a href="">字面量表达式</a></p> <p><em>基本表达式</em> → <a href="">self 表达式</a></p> <p><em>基本表达式</em> → <a href="">父类表达式</a></p> <p><em>基本表达式</em> → <a href="">闭包表达式</a></p> <p><em>基本表达式</em> → <a href="">圆括号表达式</a></p> <p><em>基本表达式</em> → <a href="">隐式成员表达式</a></p> <p><em>基本表达式</em> → <a href="">通配符表达式</a></p> <p><em>基本表达式</em> → <a href="">选择器表达式</a></p> <p><em>基本表达式</em> → <a href="">key-path字符串表达式</a></p></blockquote> <h3 id="字面量表达式"><a href="#字面量表达式" class="header-anchor">#</a> 字面量表达式</h3> <p><em>字面量表达式</em>可由普通字面量（例如字符串或者数字），字典或者数组字面量，或者下面列表中的特殊字面量组成：</p> <table><thead><tr><th>字面量</th> <th>类型</th> <th>值</th></tr></thead> <tbody><tr><td><code>#file</code></td> <td><code>String</code></td> <td>所在的文件名及模块</td></tr> <tr><td><code>#filePath</code></td> <td><code>String</code></td> <td>所在的文件路径</td></tr> <tr><td><code>#line</code></td> <td><code>Int</code></td> <td>所在的行数</td></tr> <tr><td><code>#column</code></td> <td><code>Int</code></td> <td>所在的列数</td></tr> <tr><td><code>#function</code></td> <td><code>String</code></td> <td>所在的声明的名字</td></tr> <tr><td><code>#dsohandle</code></td> <td><code>UnsafeRawPointer</code></td> <td>所使用的 DSO（动态共享对象）句柄</td></tr></tbody></table> <p><code>#file</code> 表达式的值的格式是 <em>module</em>/<em>file</em>，<em>file</em> 是表达式所在的文件名，<em>module</em> 是文件所所在的模块名。<code>#filePath</code> 表达式的字符串值是表达式所在的文件在整个文件系统里的路径。所有这些值可以被 <code>#sourceLocation</code> 改变，详见 <a href="">行控制语句</a>。</p> <blockquote><p>注意</p> <p>要解析 <code>#file</code> 表达式，第一个斜杠（/）之前的文本作为模块名，最后一个斜杠之后的文本作为文件名。将来，该字符串可能包含多个斜杠，例如 <code>MyModule/some/disambiguation/MyFile.swift</code>。</p></blockquote> <p>对于 <code>#function</code>，在函数中会返回当前函数的名字，在方法中会返回当前方法的名字，在属性的存取器中会返回属性的名字，在特殊的成员如 <code>init</code> 或 <code>subscript</code> 中会返回这个关键字的名字，在某个文件中会返回当前模块的名字。</p> <p>当其作为函数或者方法的默认参数值时，该字面量的值取决于函数或方法的调用环境。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">logFunctionName</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token literal constant">#function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function-definition function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">logFunctionName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 打印“myFunction()”</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>数组字面量是值的有序集合，形式如下：</p> <blockquote><p>[<code>值 1</code>, <code>值 2</code>, <code>...</code>]</p></blockquote> <p>数组中的最后一个表达式可以紧跟一个逗号。数组字面量的类型是 <code>[T]</code>，这个 <code>T</code> 就是数组中元素的类型。如果数组中包含多种类型，<code>T</code> 则是跟这些类型最近的的公共父类型。空数组字面量由一组方括号定义，可用来创建特定类型的空数组。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> emptyArray<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Double</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>字典字面量是一个包含无序键值对的集合，形式如下：</p> <blockquote><p>[<code>键 1</code> : <code>值 1</code>, <code>键 2</code> : <code>值 2</code>, <code>...</code>]</p></blockquote> <p>字典中的最后一个表达式可以紧跟一个逗号。字典字面量的类型是 <code>[Key : Value]</code>，<code>Key</code> 表示键的类型，<code>Value</code> 表示值的类型。如果字典中包含多种类型，那么 <code>Key</code> 表示的类型则为所有键最接近的公共父类型，<code>Value</code> 与之相似。一个空的字典字面量由方括号中加一个冒号组成（<code>[:]</code>），从而与空数组字面量区分开，可以使用空字典字面量来创建特定类型的字典。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> emptyDictionary<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Xcode 使用 playground 字面量对程序编辑器中的颜色、文件或者图片创建可交互的展示。在 Xcode 之外的空白文本中，playground 字面量使用一种特殊的字面量语法来展示。</p> <p>更多关于在 Xcode 中使用 playground 字面量的信息，请参阅 <a href="https://help.apple.com/xcode/mac/current/#/dev4c60242fc" target="_blank" rel="noopener noreferrer">添加颜色、文件或图片字面量<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>字面量表达式语法</p> <h4 id="literal-expression"><a href="#literal-expression" class="header-anchor">#</a> literal-expression</h4> <p><em>字面量表达式</em> → <a href="">字面量</a></p> <p><em>字面量表达式</em> → <a href="">数组字面量</a> | <a href="">字典字面量</a> | <a href="">练习场字面量</a></p> <p><em>字面量表达式</em> → <strong>#file</strong> ｜ <strong>#filePath</strong> | <strong>#line</strong> | <strong>#column</strong> | <strong>#function</strong></p> <h4 id="array-literal"><a href="#array-literal" class="header-anchor">#</a> array-literal</h4> <p><em>数组字面量</em> → [<a href="">数组字面量项列表</a>可选 <strong>]</strong></p> <h4 id="array-literal-items"><a href="#array-literal-items" class="header-anchor">#</a> array-literal-items</h4> <p><em>数组字面量项列表</em> → <a href="">数组字面量项</a> **,**可选 | <a href="">数组字面量项</a> <strong>,</strong> <a href="">数组字面量项列表</a></p> <h4 id="array-literal-item"><a href="#array-literal-item" class="header-anchor">#</a> array-literal-item</h4> <p><em>数组字面量项</em> → <a href="">表达式</a></p> <h4 id="dictionary-literal"><a href="#dictionary-literal" class="header-anchor">#</a> dictionary-literal</h4> <p><em>字典字面量</em> → [<a href="">字典字面量项列表</a> <strong>]</strong> | <strong>[</strong> <strong>:</strong> <strong>]</strong></p> <h4 id="dictionary-literal-items"><a href="#dictionary-literal-items" class="header-anchor">#</a> dictionary-literal-items</h4> <p><em>字典字面量项列表</em> → <a href="">字典字面量项</a> **,**可选 | <a href="">字典字面量项</a> <strong>,</strong> <a href="">字典字面量项列表</a></p> <h4 id="dictionary-literal-item"><a href="#dictionary-literal-item" class="header-anchor">#</a> dictionary-literal-item</h4> <p><em>字典字面量项</em> → <a href="">表达式</a> <strong>:</strong> <a href="">表达式</a>。</p> <h4 id="playground-literal"><a href="#playground-literal" class="header-anchor">#</a> playground-literal</h4> <p><em>playground 字面量</em> → <strong>#colorLiteral ( red :</strong> <a href=""><strong>表达式</strong></a> <strong>, green :</strong><a href=""><strong>表达式</strong></a> <strong>[表达式](#e</strong><a href=""><em><strong>表达式</strong></em></a> <strong>xpression) , blue :</strong><a href=""><strong>表达式</strong></a> <strong>, alpha :</strong> <a href=""><strong>表达式</strong></a> <strong>)</strong></p> <p><em>playground 字面量</em> → <strong>#fileLiteral ( resourceName :</strong> <a href=""><strong>表达式</strong></a> <strong>)</strong></p> <h4 id="playground-字面量-→-imageliteral-resourcename-表达式-self-expression"><a href="#playground-字面量-→-imageliteral-resourcename-表达式-self-expression" class="header-anchor">#</a> playground 字面量 <em>→ *#imageLiteral ( resourceName :</em> <a href=""><em>表达式</em></a> *)*self-expression</h4></blockquote> <h3 id="self-表达式"><a href="#self-表达式" class="header-anchor">#</a> Self 表达式</h3> <p><code>self</code> 表达式是对当前类型或者当前实例的显式引用，它有如下形式：</p> <blockquote><p>self</p> <p>self.<code>成员名称</code></p> <p>self[<code>下标索引</code>]</p> <p>self(<code>构造器参数</code>)</p> <p>self.init(<code>构造器参数</code>)</p></blockquote> <p>如果在构造器、下标、实例方法中，<code>self</code> 引用的是当前类型的实例。在一个类型方法中，<code>self</code> 引用的是当前的类型。</p> <p>当访问成员时，<code>self</code> 可用来区分重名变量，例如函数的参数：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> greeting<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token keyword">init</span><span class="token punctuation">(</span>greeting<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> greeting
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在 <code>mutating</code> 方法中，你可以对 <code>self</code> 重新赋值：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">struct</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function-definition function">moveByX</span><span class="token punctuation">(</span>deltaX<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> y deltaY<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> deltaX<span class="token punctuation">,</span> y<span class="token punctuation">:</span> y <span class="token operator">+</span> deltaY<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>Self 表达式语法</p></blockquote> <h4 id="self-expression"><a href="#self-expression" class="header-anchor">#</a> self-expression</h4> <blockquote><p><em>self 表达式</em> → <strong>self</strong> | <a href="">self 方法表达式</a> ｜ <a href="">self 下标表达式</a> | <a href="">self 构造器表达式</a></p></blockquote> <h4 id="self-method-expression"><a href="#self-method-expression" class="header-anchor">#</a> self-method-expression</h4> <blockquote><p><em>self 方法表达式</em> → <strong>self</strong> <strong>.</strong> <a href="">标识符</a></p></blockquote> <h4 id="self-subscript-expression"><a href="#self-subscript-expression" class="header-anchor">#</a> self-subscript-expression</h4> <blockquote><p><em>self 下标表达式</em> → <strong>self</strong> <strong>[</strong> <a href="">函数调用参数表</a> <strong>]</strong></p></blockquote> <h4 id="self-initializer-expression"><a href="#self-initializer-expression" class="header-anchor">#</a> self-initializer-expression</h4> <blockquote><p><em>self 构造器表达式</em> → <strong>self</strong> <strong>.</strong> <strong>init</strong></p></blockquote> <h3 id="父类表达式"><a href="#父类表达式" class="header-anchor">#</a> 父类表达式</h3> <p><em>父类</em>表达式可以使我们在某个类中访问它的父类，它有如下形式：</p> <blockquote><p>super.<code>成员名称</code></p> <p>super[<code>下标索引</code>]</p> <p>super.init(<code>构造器参数</code>)</p></blockquote> <p>第一种形式用来访问父类的某个成员，第二种形式用来访问父类的下标，第三种形式用来访问父类的构造器。</p> <p>子类可以通过父类表达式在它们的成员、下标和构造器中使用父类中的实现。</p> <blockquote><p>父类表达式语法</p></blockquote> <h4 id="superclass-expression"><a href="#superclass-expression" class="header-anchor">#</a> superclass-expression</h4> <blockquote><p><em>父类表达式</em> → <a href="">父类方法表达式</a> | <a href="">父类下标表达式</a> | <a href="">父类构造器表达式</a></p></blockquote> <h4 id="superclass-method-expression"><a href="#superclass-method-expression" class="header-anchor">#</a> superclass-method-expression</h4> <blockquote><p><em>父类方法表达式</em> → <strong>super</strong> <strong>.</strong> <a href="">标识符</a></p></blockquote> <h4 id="superclass-subscript-expression"><a href="#superclass-subscript-expression" class="header-anchor">#</a> superclass-subscript-expression</h4> <blockquote><p><em>父类下标表达式</em> → <strong>super</strong> [<a href="">函数调用参数表</a> <strong>]</strong></p></blockquote> <h4 id="superclass-initializer-expression"><a href="#superclass-initializer-expression" class="header-anchor">#</a> superclass-initializer-expression</h4> <blockquote><p><em>父类构造器表达式</em> → <strong>super</strong> <strong>.</strong> <strong>init</strong></p></blockquote> <h3 id="闭包表达式"><a href="#闭包表达式" class="header-anchor">#</a> 闭包表达式</h3> <p><em>闭包表达式</em>会创建一个闭包，在其他语言中也叫 <em>lambda</em> 或<em>匿名</em>函数。跟函数一样，闭包包含了待执行的代码，不同的是闭包还会捕获所在环境中的常量和变量。它的形式如下：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token punctuation">{</span> <span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">return</span> type <span class="token keyword">in</span>
    statements
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>闭包的参数声明形式跟函数一样，请参阅 <a href="">函数声明</a>。</p> <p>闭包还有几种特殊的形式，能让闭包使用起来更加简洁：</p> <ul><li>闭包可以省略它的参数和返回值的类型。如果省略了参数名和所有的类型，也要省略 <code>in</code> 关键字。如果被省略的类型无法被编译器推断，那么就会导致编译错误。</li> <li>闭包可以省略参数名，参数会被隐式命名为 <code>$</code> 加上其索引位置，例如 <code>$0</code>、<code>$1</code>、<code>$2</code> 分别表示第一个、第二个、第三个参数，以此类推。</li> <li>如果闭包中只包含一个表达式，那么该表达式的结果就会被视为闭包的返回值。表达式结果的类型也会被推断为闭包的返回类型。</li></ul> <p>下面几个闭包表达式是等价的：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>myFunction <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token keyword">in</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>


myFunction <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>


myFunction <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token short-argument">$0</span> <span class="token operator">+</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span>


myFunction <span class="token punctuation">{</span> <span class="token short-argument">$0</span> <span class="token operator">+</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>关于如何将闭包作为参数来传递的内容，请参阅 <a href="">函数调用表达式</a>。</p> <p>使用闭包表达式时，可以不必将其存储在一个变量或常量中，例如作为函数调用的一部分来立即使用一个闭包。在上面的例子中，传入 <code>myFunction</code> 的闭包表达式就是这种立即使用类型的闭包。因此，一个闭包是否逃逸与其使用时的上下文相关。一个会被立即调用或者作为函数的非逃逸参数传递的闭包表达式是非逃逸的，否则，这个闭包表达式是逃逸的。</p> <p>关于逃逸闭包的内容，请参阅 <a href="">逃逸闭包</a>。</p> <h2 id="捕获列表"><a href="#捕获列表" class="header-anchor">#</a> 捕获列表</h2> <p>默认情况下，闭包会捕获附近作用域中的常量和变量，并使用强引用指向它们。你可以通过一个<em>捕获列表</em>来显式指定它的捕获行为。</p> <p>捕获列表在参数列表之前，由中括号括起来，里面是由逗号分隔的一系列表达式。一旦使用了捕获列表，就必须使用 <code>in</code> 关键字，即使省略了参数名、参数类型和返回类型。</p> <p>捕获列表中的项会在闭包创建时被初始化。每一项都会用闭包附近作用域中的同名常量或者变量的值初始化。例如下面的代码示例中，捕获列表包含 <code>a</code> 而不包含 <code>b</code>，这将导致这两个变量具有不同的行为。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">let</span> closure <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token keyword">in</span>
    <span class="token function">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


a <span class="token operator">=</span> <span class="token number">10</span>
b <span class="token operator">=</span> <span class="token number">10</span>
<span class="token function">closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 打印“0 10”</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在示例中，变量 <code>b</code> 只有一个，然而，变量 <code>a</code> 有两个，一个在闭包外，一个在闭包内。闭包内的变量 <code>a</code> 会在闭包创建时用闭包外的变量 <code>a</code> 的值来初始化，除此之外它们并无其他联系。这意味着在闭包创建后，改变某个 <code>a</code> 的值都不会对另一个 <code>a</code> 的值造成任何影响。与此相反，闭包内外都是同一个变量 <code>b</code>，因此在闭包外改变其值，闭包内的值也会受影响。</p> <p>如果闭包捕获的值具有引用语义则有所不同。例如，下面示例中，有两个变量 <code>x</code>，一个在闭包外，一个在闭包内，由于它们的值是引用语义，虽然这是两个不同的变量，它们却都引用着同一实例。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SimpleClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token class-name">SimpleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token class-name">SimpleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> closure <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token keyword">in</span>
    <span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>value<span class="token punctuation">,</span> y<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


x<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10</span>
y<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10</span>
<span class="token function">closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 打印“10 10”</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>如果捕获列表中的值是类类型，你可以使用 <code>weak</code> 或者 <code>unowned</code> 来修饰它，闭包会分别用弱引用和无主引用来捕获该值。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code>myFunction <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">}</span>                    <span class="token comment">// 隐式强引用捕获</span>
myFunction <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">}</span>             <span class="token comment">// 显式强引用捕获</span>
myFunction <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token keyword">weak</span> <span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token operator">!</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">}</span>   <span class="token comment">// 弱引用捕获</span>
myFunction <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token keyword">unowned</span> <span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token comment">// 无主引用捕获</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在捕获列表中，也可以将任意表达式的值绑定到一个常量上。该表达式会在闭包被创建时进行求值，闭包会按照指定的引用类型来捕获表达式的值。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// 以弱引用捕获 self.parent 并赋值给 parent</span>
myFunction <span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token keyword">weak</span> parent <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>parent<span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token function">print</span><span class="token punctuation">(</span>parent<span class="token operator">!</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>关于闭包表达式的更多信息和例子，请参阅 <a href="">闭包表达式</a>。关于捕获列表的更多信息和例子，请参阅 <a href="">解决闭包引起的循环强引用</a>。</p> <blockquote><p>闭包表达式语法</p> <h4 id="closure-expression"><a href="#closure-expression" class="header-anchor">#</a> closure-expression</h4> <p><em>闭包表达式</em> → <strong>{</strong> <a href="">闭包签名</a>可选 <a href="">语句</a> <strong>}</strong></p> <h4 id="closure-signature"><a href="#closure-signature" class="header-anchor">#</a> closure-signature</h4> <p>闭包签名 <em>→</em> <a href=""><em>参数子句</em></a> <a href=""><em>函数结果</em></a><em>可选 *in</em></p> <p><em>闭包签名</em> → <a href="">标识符列表</a> <a href="">函数结果</a>可选 <strong>in</strong></p> <p><em>闭包签名</em> → <a href="">捕获列表</a> <a href="">参数子句</a> <a href="">函数结果</a>可选 <strong>in</strong></p> <p><em>闭包签名</em> → <a href="">捕获列表</a> <a href="">标识符列表</a> <a href="">函数结果</a>可选 <strong>in</strong></p> <p><em>闭包签名</em> → <a href="">捕获列表</a> <strong>in</strong></p> <h4 id="capture-list"><a href="#capture-list" class="header-anchor">#</a> capture-list</h4> <p>捕获列表 <em>→ [</em> <a href=""><em>捕获列表项列表</em></a> *<em>]</em></p> <h4 id="capture-list-items"><a href="#capture-list-items" class="header-anchor">#</a> capture-list-items</h4> <p><em>捕获列表项列表</em> → <a href="">捕获列表项</a> | <a href="">捕获列表项</a> <strong>,</strong> <a href="">捕获列表项列表</a></p> <h4 id="capture-list-item"><a href="#capture-list-item" class="header-anchor">#</a> capture-list-item</h4> <p><em>捕获列表项</em> → <a href="">捕获说明符</a>可选 <a href="">表达式</a></p> <h4 id="capture-specifier"><a href="#capture-specifier" class="header-anchor">#</a> capture-specifier</h4> <p><em>捕获说明符</em> → <strong>weak</strong> | <strong>unowned</strong> | <strong>unowned(safe)</strong> | <strong>unowned(unsafe)</strong></p></blockquote> <h3 id="隐式成员表达式"><a href="#隐式成员表达式" class="header-anchor">#</a> 隐式成员表达式</h3> <p>若类型可被推断出来，可以使用<em>隐式成员表达式</em>来访问某个类型的成员（例如某个枚举成员或某个类型方法），形式如下：</p> <blockquote><p>.<code>成员名称</code></p></blockquote> <p>例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token class-name">MyEnumeration</span><span class="token punctuation">.</span><span class="token class-name">SomeValue</span>
x <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token class-name">AnotherValue</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>隐式成员表达式语法</p></blockquote> <h4 id="implicit-member-expression"><a href="#implicit-member-expression" class="header-anchor">#</a> implicit-member-expression</h4> <blockquote><p><em>隐式成员表达式</em> → <strong>.</strong> <a href="">标识符</a></p></blockquote> <h3 id="圆括号表达式"><a href="#圆括号表达式" class="header-anchor">#</a> 圆括号表达式</h3> <p><em>圆括号表达式</em>是由圆括号包围的表达式。你可以用圆括号说明成组的表达式的先后操作。成组的圆括号不会改变表达式的类型 - 例如 <code>(1)</code> 的类型就是简单的 <code>Int</code>。</p> <blockquote><p>圆括号表达式语法</p></blockquote> <h4 id="parenthesized-expression"><a href="#parenthesized-expression" class="header-anchor">#</a> parenthesized-expression</h4> <blockquote><p><em>圆括号表达式</em> → <strong>(</strong> <a href=""><strong>表达式</strong></a> <strong>)</strong></p></blockquote> <h3 id="元组表达式"><a href="#元组表达式" class="header-anchor">#</a> 元组表达式</h3> <p><em>元组表达式</em>由圆括号和其中多个逗号分隔的子表达式组成。每个子表达式前面可以有一个标识符，用冒号隔开。元组表达式形式如下：</p> <blockquote><p>(<code>标识符 1</code> : <code>表达式 1</code>, <code>标识符 2</code> : <code>表达式 2</code>, <code>...</code>)</p></blockquote> <p>元组表达式里的每一个标识符在表达式作用域里必须是唯一的。在嵌套的元组表达式中，同嵌套层级里的标识符也必须是唯一的。例如，<code>(a: 10, a: 20)</code> 是不合法的，因为标签 <code>a</code> 在同一层级出现了两次。然而，<code>(a: 10, b: (a: 1, x: 2))</code> 是合法的，尽管 <code>a</code> 出现了两次，但有一次在外层元组里，一次在内层元组里。</p> <p>元组表达式可以一个表达式都没有，也可以包含两个或是更多的表达式。单个表达式用括号括起来就是括号表达式了。</p> <blockquote><p>注意</p> <p>在 Swift 中，空的元组表达式和空的元组类型都写作 <code>()</code>。由于 <code>Void</code> 是 <code>()</code> 的类型别名，因此可以使用它来表示空的元组类型。虽然如此，<code>Void</code> 就像所有的类型别名一样，永远是一个类型——不能表示空的元组表达式。</p> <p>元组表达式语法</p></blockquote> <h4 id="tuple-expression"><a href="#tuple-expression" class="header-anchor">#</a> tuple-expression</h4> <blockquote><p><em>元组表达式</em> → <strong>( )</strong> | <strong>(</strong><a href="">元组元素</a>， <a href="">元组元素列表</a> <strong>)</strong></p></blockquote> <h4 id="tuple-element-list"><a href="#tuple-element-list" class="header-anchor">#</a> tuple-element-list</h4> <blockquote><p><em>元组元素列表</em> → <a href="">元组元素</a> | <a href="">元组元素</a> <strong>,</strong> <a href="">元组元素列表</a></p></blockquote> <h4 id="tuple-element"><a href="#tuple-element" class="header-anchor">#</a> tuple-element</h4> <blockquote><p><em>元组元素</em> → <a href="">表达式</a> | <a href="">标识符</a> <strong>:</strong> <a href="">表达式</a></p></blockquote> <h3 id="通配符表达式"><a href="#通配符表达式" class="header-anchor">#</a> 通配符表达式</h3> <p><em>通配符表达式</em>可以在赋值过程中显式忽略某个值。例如下面的代码中，<code>10</code> 被赋值给 <code>x</code>，而 <code>20</code> 则被忽略：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token omit keyword">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">// x 为 10，20 被忽略</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>通配符表达式语法</p></blockquote> <h4 id="wildcard-expression"><a href="#wildcard-expression" class="header-anchor">#</a> wildcard-expression</h4> <blockquote><p><em>通配符表达式</em> → <strong>_</strong></p></blockquote> <h3 id="key-path-表达式"><a href="#key-path-表达式" class="header-anchor">#</a> Key-path 表达式</h3> <p>Key-path 表达式引用一个类型的属性或下标。在动态语言中使场景可以使用 Key-path 表达式，例如观察键值对。格式为：</p> <blockquote><p><strong>\类型名.路径</strong></p></blockquote> <p><em>类型名</em>是一个具体类型的名称，包含任何泛型参数，例如 <code>String</code>、<code>[Int]</code> 或 <code>Set&lt;Int&gt;</code>。</p> <p><em>路径</em>可由属性名称、下标、可选链表达式或者强制解包表达式组成。以上任意 key-path 组件可以以任何顺序重复多次。</p> <p>在编译期，key-path 表达式会被一个 <a href="https://developer.apple.com/documentation/swift/keypath" target="_blank" rel="noopener noreferrer">KeyPath<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 类的实例替换。</p> <p>对于所有类型，都可以通过传递 key-path 参数到下标方法 <code>subscript(keyPath:)</code> 来访问它的值。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">struct</span> <span class="token class-name">SomeStructure</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> someValue<span class="token punctuation">:</span> <span class="token class-name">Int</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">SomeStructure</span><span class="token punctuation">(</span>someValue<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> pathToProperty <span class="token operator">=</span> <span class="token punctuation">\</span><span class="token class-name">SomeStructure</span><span class="token punctuation">.</span>someValue


<span class="token keyword">let</span> value <span class="token operator">=</span> s<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> pathToProperty<span class="token punctuation">]</span>
<span class="token comment">// 值为 12</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在一些可以通过类型推断来确定所访问的具体类型的上下文中，可以省略 key-path 前的类型名字。下面的代码使用 <code>\.someProperty</code> 代替了 <code>SomeClass.someProperty</code> ：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span> <span class="token punctuation">{</span>
    <span class="token attribute atrule">@objc</span> <span class="token keyword">dynamic</span> <span class="token keyword">var</span> someProperty<span class="token punctuation">:</span> <span class="token class-name">Int</span>
    <span class="token keyword">init</span><span class="token punctuation">(</span>someProperty<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>someProperty <span class="token operator">=</span> someProperty
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token class-name">SomeClass</span><span class="token punctuation">(</span>someProperty<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>someProperty<span class="token punctuation">)</span> <span class="token punctuation">{</span> object<span class="token punctuation">,</span> change <span class="token keyword">in</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>使用 <code>self</code> 作为路径可以创建一个恒等 key path (<code>\.self</code>)。恒等 key path 可以作为整个实例的引用，因此你仅需一步操作便可以利用它来访问以及修改其存储的所有数据。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> compoundValue <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">// 等价于 compoundValue = (a: 10, b: 20)</span>
compoundValue<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>通过点语法，可以让路径包含多个属性名称，以此来访问某实例的属性的属性。下面的代码使用 key-path 表达式 <code>\OuterStructure.outer.someValue</code> 来访问 <code>OuterStructure</code> 类型中 <code>outer</code> 属性的 <code>someValue</code> 属性。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">struct</span> <span class="token class-name">OuterStructure</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> outer<span class="token punctuation">:</span> <span class="token class-name">SomeStructure</span>
    <span class="token keyword">init</span><span class="token punctuation">(</span>someValue<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>outer <span class="token operator">=</span> <span class="token class-name">SomeStructure</span><span class="token punctuation">(</span>someValue<span class="token punctuation">:</span> someValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> nested <span class="token operator">=</span> <span class="token class-name">OuterStructure</span><span class="token punctuation">(</span>someValue<span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> nestedKeyPath <span class="token operator">=</span> <span class="token punctuation">\</span><span class="token class-name">OuterStructure</span><span class="token punctuation">.</span>outer<span class="token punctuation">.</span>someValue


<span class="token keyword">let</span> nestedValue <span class="token operator">=</span> nested<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> nestedKeyPath<span class="token punctuation">]</span>
<span class="token comment">// nestedValue 的值为 24</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>路径中也可以包含使用中括号的下标访问，只要下标访问的参数类型满足 <code>Hashable</code> 协议即可。下面的例子在 key path 中使用了下标来访问数组的第二个元素。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> greetings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;hello&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;hola&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;bonjour&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;안녕&quot;</span></span><span class="token punctuation">]</span>
<span class="token keyword">let</span> myGreeting <span class="token operator">=</span> greetings<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment">// myGreeting 的值为 'hola'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>下标访问中使用的值可以是一个变量或者字面量，并且 key-path 表达式会使用值语义来捕获此值。下面的代码在 key-path 表达式和闭包中都使用了 <code>index</code> 变量来访问 <code>greetings</code> 数组的第三个元素。当 <code>index</code> 被修改时，key-path 表达式仍旧引用数组第三个元素，而闭包则使用了新的索引值。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span>
<span class="token keyword">let</span> fn<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token punctuation">{</span> strings <span class="token keyword">in</span> strings<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token punctuation">}</span>


<span class="token function">print</span><span class="token punctuation">(</span>greetings<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> path<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;bonjour&quot;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span>greetings<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;bonjour&quot;</span>


<span class="token comment">// 将 'index' 设置为一个新的值不会影响到 'path'</span>
index <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token function">print</span><span class="token punctuation">(</span>greetings<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> path<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;bonjour&quot;</span>


<span class="token comment">// 'fn' 闭包使用了新值。</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span>greetings<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;안녕&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>路径可以使用可选链和强制解包。下面的代码在 key path 中使用了可选链来访问可选字符串的属性。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> firstGreeting<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token operator">?</span> <span class="token operator">=</span> greetings<span class="token punctuation">.</span>first
<span class="token function">print</span><span class="token punctuation">(</span>firstGreeting<span class="token operator">?</span><span class="token punctuation">.</span>count <span class="token keyword">as</span> <span class="token keyword">Any</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;Optional(5)&quot;</span>


<span class="token comment">// 使用 key path 实现同样的功能</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> greetings<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token operator">?</span><span class="token punctuation">.</span>count<span class="token punctuation">]</span>
<span class="token function">print</span><span class="token punctuation">(</span>count <span class="token keyword">as</span> <span class="token keyword">Any</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;Optional(5)&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>可以混合使用各种 key path 组件来访问一些深度嵌套类型的值。下面的代码通过组合不同的组件，使用 key-path 表达式访问了一个字典数组中不同的值和属性。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> interestingNumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;prime&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token string-literal"><span class="token string">&quot;triangular&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token string-literal"><span class="token string">&quot;hexagonal&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token function">print</span><span class="token punctuation">(</span>interestingNumbers<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;prime&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token keyword">Any</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;Optional([2, 3, 5, 7, 11, 13, 17])&quot;</span>
<span class="token function">print</span><span class="token punctuation">(</span>interestingNumbers<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;prime&quot;</span></span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;2&quot;</span>
<span class="token function">print</span><span class="token punctuation">(</span>interestingNumbers<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;hexagonal&quot;</span></span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">.</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;7&quot;</span>
<span class="token function">print</span><span class="token punctuation">(</span>interestingNumbers<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;hexagonal&quot;</span></span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">.</span>count<span class="token punctuation">.</span>bitWidth<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;64&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>你可以在平时提供函数或者闭包的上下文里使用 key path 表达式。特别地，你可以用根类型是 <code>SomeType</code> 和路径产生 <code>Value</code> 类型值的 key path 表达式来替换类型是 <code>(SomeType) -&gt; Value</code> 的函数或者闭包。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">struct</span> <span class="token class-name">Task</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> description<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token keyword">var</span> completed<span class="token punctuation">:</span> <span class="token class-name">Bool</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> toDoList <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token class-name">Task</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Practice ping-pong.&quot;</span></span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Task</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Buy a pirate costume.&quot;</span></span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Task</span><span class="token punctuation">(</span>description<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Visit Boston in the Fall.&quot;</span></span><span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>


<span class="token comment">// 下面两种写法是等价的。</span>
<span class="token keyword">let</span> descriptions <span class="token operator">=</span> toDoList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>description<span class="token punctuation">)</span>
<span class="token keyword">let</span> descriptions2 <span class="token operator">=</span> toDoList<span class="token punctuation">.</span>filter <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>completed <span class="token punctuation">}</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>description <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>任何 key path 表达式的副作用发生的关键在于表达式在哪里被执行。例如，如果你在 key path 表达式中的一个下标里使用函数调用，该函数只会在表达式计算的时候调用一次，而不是每次这个 key path 被使用的时候。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">makeIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Made an index&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token comment">// 下面这行调用 makeIndex()。</span>
<span class="token keyword">let</span> taskKeyPath <span class="token operator">=</span> <span class="token punctuation">\</span><span class="token punctuation">[</span><span class="token class-name">Task</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">makeIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment">// 打印 &quot;Made an index&quot;</span>


<span class="token comment">// 使用 taskKeyPath 不会再次调用 makeIndex()。</span>
<span class="token keyword">let</span> someTask <span class="token operator">=</span> toDoList<span class="token punctuation">[</span>keyPath<span class="token punctuation">:</span> taskKeyPath<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>关于更多如何使用 key path 与 Objective-C APIs 交互的信息，请参阅 <a href="https://developer.apple.com/documentation/swift/using_objective_c_runtime_features_in_swift" target="_blank" rel="noopener noreferrer">在 Swift 中使用 Objective-C 运行时特性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。关于更多 key-value 编程和 key-value 观察的信息，请参阅 <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueCoding/index.html#//apple-ref/doc/uid/10000107i" target="_blank" rel="noopener noreferrer">Key-Value 编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple-ref/doc/uid/10000177i" target="_blank" rel="noopener noreferrer">Key-Value 观察编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>key-path 表达式语法</p> <h4 id="key-path-expression"><a href="#key-path-expression" class="header-anchor">#</a> key-path-expression</h4> <p><em>key-path 表达式</em> → *<em>*</em> <a href="">类型</a>可选 <strong>.</strong> <a href="">多个 key-path 组件</a></p> <h4 id="key-path-components"><a href="#key-path-components" class="header-anchor">#</a> key-path-components</h4> <p><em>多个 key-path 组件</em> → <a href="">key-path 组件</a> | <a href="">key-path 组件</a> <strong>.</strong> <a href="">多个 key-path 组件</a></p> <h4 id="key-path-component"><a href="#key-path-component" class="header-anchor">#</a> key-path-component</h4> <p><em>key-path 组件</em> → <a href="">标识符</a> <a href="">多个 key-path 后缀</a>可选 | <a href="">多个 key-path 后缀</a></p> <h4 id="key-path-postfixes"><a href="#key-path-postfixes" class="header-anchor">#</a> key-path-postfixes</h4> <h4 id="多个-key-path-后缀-→-key-path-后缀-多个-key-path-后缀可选-key-path-postfixes"><a href="#多个-key-path-后缀-→-key-path-后缀-多个-key-path-后缀可选-key-path-postfixes" class="header-anchor">#</a> <em>多个 key-path 后缀</em> →  <a href="">key-path 后缀</a> <a href="">多个 key-path 后缀</a>可选 key-path-postfixes</h4> <p><em>key-path 后缀</em> → <strong>?</strong> | <strong>!</strong> | <strong>self</strong> | <strong>[</strong> <a href="">函数调用参数表</a> <strong>]</strong></p></blockquote> <h3 id="选择器表达式"><a href="#选择器表达式" class="header-anchor">#</a> 选择器表达式</h3> <p><em>选择器表达式</em>可以让你通过选择器来引用在 Objective-C 中方法（method）和属性（property）的 setter 和 getter 方法。</p> <blockquote><p>#selector(方法名)</p> <p>#selector(getter: 属性名) #selector(setter: 属性名)</p></blockquote> <p>方法名和属性名必须是存在于 Objective-C 运行时中的方法和属性的引用。选择器表达式的返回值是一个 Selector 类型的实例。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> property<span class="token punctuation">:</span> <span class="token class-name">String</span>
    <span class="token attribute atrule">@objc</span><span class="token punctuation">(</span>doSomethingWithInt<span class="token punctuation">:</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function-definition function">doSomething</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>


    <span class="token keyword">init</span><span class="token punctuation">(</span>property<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>property <span class="token operator">=</span> property
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> selectorForMethod <span class="token operator">=</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span><span class="token class-name">SomeClass</span><span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> selectorForPropertyGetter <span class="token operator">=</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span>getter<span class="token punctuation">:</span> <span class="token class-name">SomeClass</span><span class="token punctuation">.</span>property<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>当为属性的 getter 创建选择器时，属性名可以是变量属性或者常量属性的引用。但是当为属性的 setter 创建选择器时，属性名只可以是对变量属性的引用。</p> <p>方法名称可以包含圆括号来进行分组，并使用 as 操作符来区分具有相同方法名但类型不同的方法，例如:</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>
    <span class="token attribute atrule">@objc</span><span class="token punctuation">(</span>doSomethingWithString<span class="token punctuation">:</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function-definition function">doSomething</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> x<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> anotherSelector <span class="token operator">=</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span><span class="token class-name">SomeClass</span><span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token class-name">SomeClass</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>由于选择器是在编译时创建的，因此编译器可以检查方法或者属性是否存在，以及是否在运行时暴露给了 Objective-C 。</p> <blockquote><p>注意</p> <p>虽然方法名或者属性名是个表达式，但是它不会被求值。</p></blockquote> <p>更多关于如何在 Swift 代码中使用选择器来与 Objective-C API 进行交互的信息，请参阅 <a href="https://developer.apple.com/documentation/swift/using_objective_c_runtime_features_in_swift" target="_blank" rel="noopener noreferrer">在 Swift 中使用 Objective-C 运行时特性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>选择器表达式语法</p></blockquote> <h4 id="selector-expression"><a href="#selector-expression" class="header-anchor">#</a> selector-expression</h4> <blockquote><p><em>选择器表达式</em> → __#selector-- <strong>(</strong> <a href="">表达式</a> <strong>)</strong></p> <p><em>选择器表达式</em> → __#selector-- <strong>(</strong> <a href="">getter:表达式</a> <strong>)</strong></p> <p><em>选择器表达式</em> → __#selector-- <strong>(</strong> <a href="">setter:表达式</a> <strong>)</strong></p></blockquote> <h2 id="key-path-字符串表达式"><a href="#key-path-字符串表达式" class="header-anchor">#</a> Key-path 字符串表达式</h2> <p>key-path 字符串表达式可以访问一个引用 Objective-C 属性的字符串，通常在 key-value 编程和 key-value 观察 APIs 中使用。其格式如下：</p> <blockquote><p><code>#keyPath</code> ( <code>属性名</code> )</p></blockquote> <p>属性名必须是一个可以在 Objective-C 运行时使用的属性的引用。在编译期，key-path 字符串表达式会被一个字符串字面量替换。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span> <span class="token punctuation">{</span>
    <span class="token attribute atrule">@objc</span> <span class="token keyword">var</span> someProperty<span class="token punctuation">:</span> <span class="token class-name">Int</span>
    <span class="token keyword">init</span><span class="token punctuation">(</span>someProperty<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>someProperty <span class="token operator">=</span> someProperty
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token class-name">SomeClass</span><span class="token punctuation">(</span>someProperty<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> keyPath <span class="token operator">=</span> <span class="token other-directive property">#keyPath</span><span class="token punctuation">(</span><span class="token class-name">SomeClass</span><span class="token punctuation">.</span>someProperty<span class="token punctuation">)</span>


<span class="token keyword">if</span> <span class="token keyword">let</span> value <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> keyPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 打印 &quot;12&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>当在一个类中使用 key-path 字符串表达式时，可以省略类名，直接使用属性名来访问这个类的某个属性。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function-definition function">getSomeKeyPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span> 
        <span class="token keyword">return</span> <span class="token other-directive property">#keyPath</span><span class="token punctuation">(</span>someProperty<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">print</span><span class="token punctuation">(</span>keyPath <span class="token operator">==</span> c<span class="token punctuation">.</span><span class="token function">getSomeKeyPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 打印 &quot;true&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>由于 key-path 字符串表达式在编译期才创建，编译期可以检查属性是否存在，以及属性是否暴露给 Objective-C 运行时。</p> <p>关于更多如何使用 key path 与 Objective-C APIs 交互的信息，请参阅 <a href="https://developer.apple.com/documentation/swift/using_objective_c_runtime_features_in_swift" target="_blank" rel="noopener noreferrer">在 Swift 中使用 Objective-C 运行时特性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。关于更多 key-value 编程和 key-value 观察的信息，请参阅 <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueCoding/index.md#//apple-ref/doc/uid/10000107i" target="_blank" rel="noopener noreferrer">Key-Value 编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.md#//apple-ref/doc/uid/10000177i" target="_blank" rel="noopener noreferrer">Key-Value 观察编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>注意</p> <p>尽管<em>属性名</em>是一个表达式，但它永远不会被求值</p> <p>key-path 字符串表达式语法</p> <h4 id="key-path-string-expression"><a href="#key-path-string-expression" class="header-anchor">#</a> key-path-string-expression</h4> <p><em>key-path 字符串表达式</em> → <strong>#keyPath (</strong> <a href="">表达式</a> <strong>)</strong></p></blockquote> <h2 id="后缀表达式"><a href="#后缀表达式" class="header-anchor">#</a> 后缀表达式</h2> <p><em>后缀表达式</em>就是在某个表达式的后面运用后缀运算符或其他后缀语法。从语法构成上来看，基本表达式也是后缀表达式。</p> <p>关于这些运算符的更多信息，请参阅 <a href="">基本运算符</a> 和 <a href="">高级运算符</a>。</p> <p>关于 Swift 标准库提供的运算符的更多信息，请参阅 <a href="https://developer.apple.com/documentation/swift/operator_declarations" target="_blank" rel="noopener noreferrer">运算符定义<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <blockquote><p>后缀表达式语法</p></blockquote> <h4 id="postfix-expression"><a href="#postfix-expression" class="header-anchor">#</a> postfix-expression</h4> <blockquote><p><em>后缀表达式</em> → <a href="">基本表达式</a></p> <p><em>后缀表达式</em> → <a href="">后缀表达式</a> <a href="">后缀运算符</a></p> <p><em>后缀表达式</em> → <a href="">函数调用表达式</a></p> <p><em>后缀表达式</em> → <a href="">构造器表达式</a></p> <p><em>后缀表达式</em> → <a href="">显式成员表达式</a></p> <p><em>后缀表达式</em> → <a href="">后缀 self 表达式</a></p> <p><em>后缀表达式</em> → <a href="">dynamicType 表达式</a></p> <p><em>后缀表达式</em> → <a href="">下标表达式</a></p> <p><em>后缀表达式</em> → <a href="">强制取值表达式</a></p> <p><em>后缀表达式</em> → <a href="">可选链表达式</a></p></blockquote> <h3 id="函数调用表达式"><a href="#函数调用表达式" class="header-anchor">#</a> 函数调用表达式</h3> <p><em>函数调用表达式</em>由函数名和参数列表组成，形式如下：</p> <blockquote><p><code>函数名</code>(<code>参数 1</code>, <code>参数 2</code>)</p></blockquote> <p>函数名可以是值为函数类型的任意表达式。</p> <p>如果函数声明中指定了参数的名字，那么在调用的时候也必须得写出来。这种函数调用表达式具有以下形式：</p> <blockquote><p><code>函数名</code>(<code>参数名 1</code>: <code>参数 1</code>, <code>参数名 2</code>: <code>参数 2</code>)</p></blockquote> <p>如果函数的最后一个参数是函数类型，可以在函数调用表达式的尾部（右圆括号之后）加上一个闭包，该闭包会作为函数的最后一个参数。如下两种写法是等价的：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// someFunction 接受整型和闭包的实参</span>
<span class="token function">someFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token short-argument">$0</span> <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">someFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token short-argument">$0</span> <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">}</span>


<span class="token comment">// anotherFunction 接受一个整型和两个闭包的实参</span>
<span class="token function">anotherFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> x<span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span> <span class="token operator">==</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> g<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">anotherFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span> <span class="token operator">==</span> <span class="token number">13</span> <span class="token punctuation">}</span> g<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>如果闭包是该函数的唯一参数，那么圆括号可以省略。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// someFunction 只接受一个闭包参数</span>
myData<span class="token punctuation">.</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token short-argument">$0</span> <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">}</span>
myData<span class="token punctuation">.</span>someMethod <span class="token punctuation">{</span><span class="token short-argument">$0</span> <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如 <a href="">特殊名称方法</a> 所述，通过声明几种方法中的一种，类、结构体或枚举类型可以为函数调用语法启用语法糖。</p> <blockquote><p>函数调用表达式语法</p> <h4 id="function-call-expression"><a href="#function-call-expression" class="header-anchor">#</a> function-call-expression</h4> <p><em>函数调用表达式</em> → <a href="">后缀表达式</a> <a href="">函数调用参数子句</a></p> <p><em>函数调用表达式</em> → <a href="">后缀表达式</a> <a href="">函数调用参数子句</a>可选 <a href="">尾随闭包</a></p> <h4 id="function-call-argument-clause"><a href="#function-call-argument-clause" class="header-anchor">#</a> function-call-argument-clause</h4> <p><em>函数调用参数子句</em> → <strong>(</strong> <strong>)</strong> | <strong>(</strong> <a href="">函数调用参数表</a> <strong>)</strong></p> <h4 id="function-call-argument-list"><a href="#function-call-argument-list" class="header-anchor">#</a> function-call-argument-list</h4> <p><em>函数调用参数表</em> → <a href="">函数调用参数</a> | <a href="">函数调用参数</a> <strong>,</strong> <a href=""><em>函数调用参数表</em></a></p> <h4 id="function-call-argument"><a href="#function-call-argument" class="header-anchor">#</a> function-call-argument</h4> <p><em>函数调用参数</em> → <a href="">表达式</a> | <a href="">标识符</a> <strong>:</strong> <a href="">表达式</a></p> <p><em>函数调用参数</em> → <a href="/pages/4b779c/#运算符">运算符</a> | <a href="">标识符</a> <strong>:</strong> <a href="/pages/4b779c/#运算符">运算符</a></p> <h4 id="trailing-closure"><a href="#trailing-closure" class="header-anchor">#</a> trailing-closure</h4> <p><em>尾随闭包</em> → <a href="">闭包表达式</a></p> <h4 id="labeled-trailing-closures"><a href="#labeled-trailing-closures" class="header-anchor">#</a> labeled-trailing-closures</h4> <p><em>标签尾随闭包集</em> → <a href="">标签尾随闭包</a> <a href="">标签尾随闭包集</a>可选</p> <h4 id="labeled-trailing-closure"><a href="#labeled-trailing-closure" class="header-anchor">#</a> labeled-trailing-closure</h4> <p><em>标签尾随闭包</em> → <a href="">标识符</a> <strong>:</strong> <a href="">闭包表达式</a></p></blockquote> <h3 id="构造器表达式"><a href="#构造器表达式" class="header-anchor">#</a> 构造器表达式</h3> <p><em>构造器表达式</em>用于访问某个类型的构造器，形式如下：</p> <blockquote><p><code>表达式</code>.init(<code>构造器参数</code>)</p></blockquote> <p>你可以在函数调用表达式中使用构造器表达式来初始化某个类型的新实例。也可以使用构造器表达式来代理给父类构造器。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeSubClass</span><span class="token punctuation">:</span> <span class="token class-name">SomeSuperClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 此处为子类构造过程</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>和函数类似，构造器表达式可以作为一个值。 例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token comment">// 类型注解是必须的，因为 String 类型有多种构造器</span>
<span class="token keyword">let</span> initializer<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">init</span>
<span class="token keyword">let</span> oneTwoThree <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>initializer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;&quot;</span></span><span class="token punctuation">,</span> combine<span class="token punctuation">:</span> <span class="token operator">+</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>oneTwoThree<span class="token punctuation">)</span>
<span class="token comment">// 打印“123”</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果通过名字来指定某个类型，可以不用构造器表达式而直接使用类型的构造器。在其他情况下，你必须使用构造器表达式。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">SomeType</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 有效</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token class-name">SomeType</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span>      <span class="token comment">// 有效</span>


<span class="token keyword">let</span> s4 <span class="token operator">=</span> someValue<span class="token punctuation">.</span><span class="token function">dynamicType</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span>      <span class="token comment">// 错误</span>
<span class="token keyword">let</span> s3 <span class="token operator">=</span> someValue<span class="token punctuation">.</span>dynamicType<span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment">// 有效</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>构造器表达式语法</p></blockquote> <h4 id="initializer-expression"><a href="#initializer-expression" class="header-anchor">#</a> initializer-expression</h4> <blockquote><p><em>构造器表达式</em> → <a href="">后缀表达式</a> <strong>.</strong> <strong>init</strong></p> <p><em>构造器表达式</em> → <a href="">后缀表达式</a> <strong>.</strong> <strong>init</strong> <strong>(</strong> <a href="">参数名称</a> <strong>)</strong></p></blockquote> <h3 id="显式成员表达式"><a href="#显式成员表达式" class="header-anchor">#</a> 显式成员表达式</h3> <p><em>显式成员表达式</em>允许我们访问命名类型、元组或者模块的成员，其形式如下：</p> <blockquote><div class="language-swift line-numbers-mode"><pre class="language-swift"><code>表达式`<span class="token punctuation">.</span>`成员名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>命名类型的某个成员在原始实现或者扩展中定义，例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> someProperty <span class="token operator">=</span> <span class="token number">42</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token class-name">SomeClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> c<span class="token punctuation">.</span>someProperty <span class="token comment">// 访问成员</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>元组的成员会隐式地根据表示它们出现顺序的整数来命名，以 0 开始，例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
t<span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token number">1</span>
<span class="token comment">// 现在元组 t 为 (20, 20, 30)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>对于模块的成员来说，只能直接访问顶级声明中的成员。</p> <p>使用 <code>dynamicMemberLookup</code> 属性声明的类型包含可以在运行时查找的成员，具体请参阅 <a href="/pages/ce0459/">属性</a>。</p> <p>为了区分只有参数名有所不同的方法或构造器，在圆括号中写出参数名，参数名后紧跟一个冒号，对于没有参数名的参数，使用下划线代替参数名。而对于重载方法，则需使用类型注解进行区分。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function-definition function">someMethod</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">func</span> <span class="token function-definition function">someMethod</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> z<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">func</span> <span class="token function-definition function">overloadedMethod</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">func</span> <span class="token function-definition function">overloadedMethod</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token class-name">SomeClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">let</span> a <span class="token operator">=</span> instance<span class="token punctuation">.</span>someMethod              <span class="token comment">// 有歧义</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token omit keyword">_</span><span class="token punctuation">:</span>y<span class="token punctuation">:</span><span class="token punctuation">)</span>        <span class="token comment">// 无歧义</span>


<span class="token keyword">let</span> d <span class="token operator">=</span> instance<span class="token punctuation">.</span>overloadedMethod        <span class="token comment">// 有歧义</span>
<span class="token keyword">let</span> d <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">overloadedMethod</span><span class="token punctuation">(</span><span class="token omit keyword">_</span><span class="token punctuation">:</span>y<span class="token punctuation">:</span><span class="token punctuation">)</span>  <span class="token comment">// 有歧义</span>
<span class="token keyword">let</span> d<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Int</span><span class="token punctuation">,</span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>  <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">overloadedMethod</span><span class="token punctuation">(</span><span class="token omit keyword">_</span><span class="token punctuation">:</span>y<span class="token punctuation">:</span><span class="token punctuation">)</span>  <span class="token comment">// 无歧义</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>如果点号（<code>.</code>）出现在行首，它会被视为显式成员表达式的一部分，而不是隐式成员表达式的一部分。例如如下代码所展示的被分为多行的链式方法调用：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
    <span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>filter <span class="token punctuation">{</span> <span class="token short-argument">$0</span> <span class="token operator">&gt;</span> <span class="token number">5</span> <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token short-argument">$0</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>显式成员表达式语法</p></blockquote> <h4 id="explicit-member-expression"><a href="#explicit-member-expression" class="header-anchor">#</a> explicit-member-expression</h4> <blockquote><p><em>显式成员表达式</em> → <a href="">后缀表达式</a> <strong>.</strong> <a href="">十进制数字</a></p> <p><em>显式成员表达式</em> → <a href="">后缀表达式</a> <strong>.</strong> <a href="">标识符</a> <a href="">泛型实参子句</a>可选</p> <p><em>显式成员表达式</em> → <a href="">后缀表达式</a> <strong>.</strong> <a href="">标识符</a> <strong>(</strong> <a href="">参数名称</a> <strong>)</strong></p></blockquote> <h4 id="argument-names"><a href="#argument-names" class="header-anchor">#</a> argument-names</h4> <blockquote><p><em>参数名称</em> → <a href="">参数名</a> <a href="">参数名称</a>可选</p></blockquote> <h4 id="argument-name"><a href="#argument-name" class="header-anchor">#</a> argument-name</h4> <blockquote><p><em>参数名</em> → <a href="">标识符</a> <strong>:</strong></p></blockquote> <h3 id="后缀-self-表达式"><a href="#后缀-self-表达式" class="header-anchor">#</a> 后缀 self 表达式</h3> <p>后缀 <code>self</code> 表达式由某个表达式或类型名紧跟 <code>.self</code> 组成，其形式如下：</p> <blockquote><p><code>表达式</code>.self</p> <p><code>类型</code>.self</p></blockquote> <p>第一种形式返回表达式的值。例如：<code>x.self</code> 返回 <code>x</code>。</p> <p>第二种形式返回相应的类型。我们可以用它来获取某个实例的类型作为一个值来使用。例如，<code>SomeClass.self</code> 会返回 <code>SomeClass</code> 类型本身，你可以将其传递给相应函数或者方法作为参数。</p> <blockquote><p>后缀 self 表达式语法</p></blockquote> <h4 id="postfix-self-expression"><a href="#postfix-self-expression" class="header-anchor">#</a> postfix-self-expression</h4> <blockquote><p><em>后缀 self 表达式</em> → <a href="">后缀表达式</a> <strong>.</strong> <strong>self</strong></p></blockquote> <h3 id="下标表达式"><a href="#下标表达式" class="header-anchor">#</a> 下标表达式</h3> <p>可通过<em>下标表达式</em>访问相应的下标，形式如下：</p> <blockquote><p><code>表达式</code>[<code>索引表达式</code>]</p></blockquote> <p>要获取下标表达式的值，可将索引表达式作为下标表达式的参数来调用下标 getter。下标 setter 的调用方式与之一样。</p> <p>关于下标的声明，请参阅 <a href="">协议下标声明</a>。</p> <blockquote><p>下标表达式语法</p></blockquote> <h4 id="subscript-expression"><a href="#subscript-expression" class="header-anchor">#</a> subscript-expression</h4> <blockquote><p><em>下标表达式</em> → <a href="">后缀表达式</a> <strong>[</strong> <a href="">表达式列表</a> <strong>]</strong></p></blockquote> <h3 id="强制取值表达式"><a href="#强制取值表达式" class="header-anchor">#</a> 强制取值表达式</h3> <p>当你确定可选值不是 <code>nil</code> 时，可以使用<em>强制取值表达式</em>来强制解包，形式如下：</p> <blockquote><p><code>表达式</code>!</p></blockquote> <p>如果该表达式的值不是 <code>nil</code>，则返回解包后的值。否则，抛出运行时错误。</p> <p>返回的值可以被修改，无论是修改值本身，还是修改值的成员。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> x<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token number">0</span>
x<span class="token operator">!++</span>
<span class="token comment">// x 现在是 1</span>


<span class="token keyword">var</span> someDictionary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;a&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;b&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
someDictionary<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;a&quot;</span></span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment">// someDictionary 现在是 [b: [10, 20], a: [100, 2, 3]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>强制取值语法</p></blockquote> <h4 id="forced-value-expression"><a href="#forced-value-expression" class="header-anchor">#</a> forced-value-expression</h4> <blockquote><p><em>强制取值表达式</em> → <a href="">后缀表达式</a> <strong>!</strong></p></blockquote> <h3 id="可选链表达式"><a href="#可选链表达式" class="header-anchor">#</a> 可选链表达式</h3> <p><em>可选链表达式</em>提供了一种使用可选值的便捷方法，形式如下：</p> <blockquote><p><code>表达式</code>?</p></blockquote> <p>后缀 <code>?</code> 运算符会根据表达式生成可选链表达式而不会改变表达式的值。</p> <p>如果某个后缀表达式包含可选链表达式，那么它的执行过程会比较特殊。如果该可选链表达式的值是 <code>nil</code>，整个后缀表达式会直接返回 <code>nil</code>。如果该可选链表达式的值不是 <code>nil</code>，则返回可选链表达式解包后的值，并将该值用于后缀表达式中剩余的表达式。在这两种情况下，整个后缀表达式的值都会是可选类型。</p> <p>如果某个后缀表达式中包含了可选链表达式，那么只有最外层的表达式会返回一个可选类型。例如，在下面的例子中，如果 <code>c</code> 不是 <code>nil</code>，那么它的值会被解包，然后通过 <code>.property</code> 访问它的属性，接着进一步通过 <code>.performAction()</code> 调用相应方法。整个 <code>c?.property.performAction()</code> 表达式返回一个可选类型的值，而不是多重可选类型。</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> c<span class="token punctuation">:</span> <span class="token class-name">SomeClass</span><span class="token operator">?</span>
<span class="token keyword">var</span> result<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token operator">?</span> <span class="token operator">=</span> c<span class="token operator">?</span><span class="token punctuation">.</span>property<span class="token punctuation">.</span><span class="token function">performAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面的例子跟下面的不使用可选链表达式的例子等价：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">var</span> result<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span>
<span class="token keyword">if</span> <span class="token keyword">let</span> unwrappedC <span class="token operator">=</span> c <span class="token punctuation">{</span>
    result <span class="token operator">=</span> unwrappedC<span class="token punctuation">.</span>property<span class="token punctuation">.</span><span class="token function">performAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>可选链表达式解包后的值可以被修改，无论是修改值本身，还是修改值的成员。如果可选链表达式的值为 <code>nil</code>，则表达式右侧的赋值操作不会被执行。例如：</p> <div class="language-swift line-numbers-mode"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">someFunctionWithSideEffects</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span>
    <span class="token comment">// 译者注：为了能看出此函数是否被执行，加上了一句打印</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;someFunctionWithSideEffects&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">42</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> someDictionary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;a&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;b&quot;</span></span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">]</span>


someDictionary<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;not here&quot;</span></span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">someFunctionWithSideEffects</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// someFunctionWithSideEffects 不会被执行</span>
<span class="token comment">// someDictionary 依然是 [&quot;b&quot;: [10, 20], &quot;a&quot;: [1, 2, 3]]</span>


someDictionary<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;a&quot;</span></span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">someFunctionWithSideEffects</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// someFunctionWithSideEffects 被执行并返回 42</span>
<span class="token comment">// someDictionary 现在是 [&quot;b&quot;: [10, 20], &quot;a&quot;: [42, 2, 3]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>可选链表达式语法</p></blockquote> <h4 id="optional-chaining-expression"><a href="#optional-chaining-expression" class="header-anchor">#</a> optional-chaining-expression</h4> <blockquote><p><em>可选链表达式</em> → <a href="">后缀表达式</a> <strong>?</strong></p></blockquote></div></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/05/07, 16:05:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/c85eb2/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">类型</div></a> <a href="/pages/0c5243/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">语句</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/c85eb2/" class="prev">类型</a></span> <span class="next"><a href="/pages/0c5243/">语句</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/742912/"><div>Homebrew+RVM+Ruby+CocoaPods</div></a> <span>11-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/81af2e/"><div>iOS13生命周期</div></a> <span>11-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/258164/"><div>《Swift编程语言》- 语法总结</div></a> <span>11-11</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> <div class="comments-wrapper"><!----></div> </main></div> <!----> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;filter:grayscale(100%);"></div> <!----> <div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f91ba302.js" defer></script><script src="/assets/js/2.dd713b59.js" defer></script><script src="/assets/js/3.069de0ac.js" defer></script><script src="/assets/js/43.fec22db6.js" defer></script>
  </body>
</html>